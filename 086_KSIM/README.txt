The dataset is so large that numpy cannot even initialize the array unless you run with a 64-bit version of Python.

Need a C++ implementation since this does not run fast enough.